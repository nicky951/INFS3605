{% load static %}
<script>
  function checkFunction() {
    var email = document.getElementById('i25v').value;
    //get response via CORS proxy
    var jsonRequest = "https://cors-anywhere.herokuapp.com/https://haveibeenpwned.com/api/v3/breachedaccount/" + email + "?truncateResponse=false";

    var request = new XMLHttpRequest();

    request.open('GET', jsonRequest, false);
    request.setRequestHeader("hibp-api-key", "38eb580ec92d4403becca47370ac9d1f");
    request.setRequestHeader("Access-Control-Allow-Origin", "*");
    request.send();
    
    var result = JSON.parse(request.response);
    var breachTable = document.getElementById('breachtable');

    for(var i = 0; i < result.length; i++) {
      var row = breachTable.insertRow(i + 1);
      var newC1 = row.insertCell(0);
      newC1.innerHTML = result[i]['Name'];
      var newC2 = row.insertCell(1);
      newC2.innerHTML = "<img src=\"" + result[i]['LogoPath'] + "\" style = \"width: 100px; height: auto;\">";
      var newC3 = row.insertCell(2);
      newC3.innerHTML = result[i]['BreachDate'];
      var newC4 = row.insertCell(3);
      newC4.innerHTML = result[i]['Description'];
    }
    
    document.getElementById('breachtable').style.visibility = 'visible';
  }
</script>
<link rel="stylesheet" type="text/css" href= "{% static 'css/pwned.css' %}">
<div id="check_title">Check your Email
</div>
<form class="form" style="margin-left: 200px; margin-right: 200px; border-radius: 20px;">
  <div class="form-group">
  </div>
  <div class="form-group">
    <label class="label" id="ipcx">Email</label>
    <input type="email" placeholder="Type here your email" class="input" id="i25v"/>
  </div>
  <div class="form-group">
  </div>
  <div class="form-group">
    <button type="button" class="button" id="check" onclick="checkFunction()">Check</button>
  </div>
</form>
<table class="table" id="breachtable" style="visibility: hidden; font-family: Helvetica, sans-serif;">
  <thead>
      <tr>
          <th>Breach</th>
          <th>Logo</th>
          <th style="width: 200px;">Date</th>
          <th>Details</th>
      </tr>
  </thead>
  <tbody>
  </tbody>
</table>